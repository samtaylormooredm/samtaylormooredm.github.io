<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <title>Climate Concern Choropleth</title>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/7.2.0/introjs.css" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<!-- Intro Modal -->
<div id="welcome-modal" style="display:none; position: fixed; top: 30%; left: 50%; transform: translate(-50%, -50%);
background: white; border: 1px solid #ccc; padding: 20px; z-index: 9999; box-shadow: 0 2px 10px rgba(0,0,0,0.2);">
  <h3>Welcome!</h3>
  <p>Click below to take a tour of this visualization.</p>
  <button id="start-tour-btn" style="margin-top: 10px;">Start Tour</button>
</div>

<!-- Title -->
<div class="title-container">
  <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
    <h1>Estimated % of adults who are worried about global warming</h1>
    <a href="./data.html" class="data-link-button" role="button" aria-label="View the sortable data table"
      data-title="Sortable Data Table"
      data-intro="Click here to open a full table of the climate concern data by state and year. You can sort and compare values."
      data-step="6">
      View Sortable Data Table
    </a>
  </div>
</div>

<!-- Controls -->
<div class="controls">
  <div id="year-label">Year: </div>
  <div class="slider-container">
    <input type="range" aria-label="slider-container" id="year-slider"
      alt="A slider that allows the user to click and slide over the slider to see a map of each year"
      data-intro="Click and slide over the slider to see a map of each year" data-title="Year Selector" data-step="1">
    <button id="play-button" data-title="Play Button"
      data-intro="Click here to see an animation of the state populations' opinions over time." data-step="2">â–¶ Play</button>
  </div>
</div>

<!-- Map, Legend, and Chart Layout -->
<div class="map-chart-wrapper">
  
  <!-- Map -->
  <div id="map-container"
    alt="A map that highlights the percentage of each state's reported worries about global warming for that year."
    data-intro="Hover over any state to see its data. Click a state to view its trend." data-step="3">
    <svg id="map" viewBox="0 0 1100 500" preserveAspectRatio="xMidYMid meet">
      <defs>
        <filter id="hover-glow">
          <feDropShadow dx="0" dy="0" stdDeviation="2" flood-color="#FFFFED" flood-opacity="0.8"/>
        </filter>
        <filter id="selected-glow">
          <feDropShadow dx="0" dy="0" stdDeviation="3" flood-color="#FFD700" flood-opacity="1"/>
        </filter>a
      </defs>
    </svg>
  </div>

  <!-- Legend -->
  <div id="legend-container">
    <div id="legend-svg-wrapper"
      data-title="Color Legend"
      data-intro="These color bins represent percentage ranges. Click to filter."
      data-step="4">
      <!-- Legend SVG inserted here dynamically -->
    </div>
  </div>


  <!-- Chart + Unselect Button -->
  <div id="line-chart-section">
    <div id="line-chart-container" class="chart-wrapper"
      data-title="Trend View"
      data-intro="Clicking a state shows its opinion trend here over time. Click on multiple states to compare their trends over the decade." data-step="5">
      <!-- Line chart is inserted dynamically -->
    </div>

    <div id="unselect-wrapper">
      <button id="unselect-button" disabled>Unselect All States</button>
    </div>
  </div>
</div>

<!-- Accessibility Descriptions -->
<h2 class="sr-only">Map Summary: This choropleth shows the percentage of adults concerned about climate change by state and year. Darker states represent higher concern.</h2>
<h2 class="sr-only">Line Chart Summary: This line chart shows how concern about climate change changes over time for a selected state.</h2>

<!-- Hidden Link to Raw Data -->
<a class="sr-only" href="./data.html" title="An HTML page with all the information in the dataset">
  <img src="image.jpg" alt="An HTML page with all the information in the dataset" />
</a>

<!-- Tooltip -->
<div class="tooltip" id="tooltip"></div>

<!-- Animation Warning -->
<div id="popup-warning" style="
  display: none;
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background-color: #ffefc5;
  color: #333;
  padding: 10px 18px;
  border: 1px solid #e0c177;
  border-radius: 6px;
  font-size: 15px;
  z-index: 1000;
  box-shadow: 0px 2px 8px rgba(0,0,0,0.15);
  transition: opacity 0.3s ease;
">
  Pause animation to select a state.
</div>

<!-- Scripts -->
<script src="main.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/7.2.0/intro.min.js"></script>

</body>
</html>

